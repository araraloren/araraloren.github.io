<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Linux移除应用程序启动通知 | Loren&#39;s Blog</title>
  <meta name="author" content="araraloren">
  
  <meta name="description" content="大家好">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Linux移除应用程序启动通知"/>
  <meta property="og:site_name" content="Loren&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/journal.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar  navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">Loren&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header ">		
			<h1 class="title "> Linux移除应用程序启动通知</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>c++&#x7684;&#x6A21;&#x677F;&#x662F;c++&#x6CDB;&#x578B;&#x7F16;&#x7A0B;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x4F7F;&#x7528;&#x6A21;&#x677F;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5199;&#x51FA;&#x5F88;&#x591A;&#x901A;&#x7528;&#x7684;&#x7C7B;&#xFF0C;&#x518D;&#x52A0;&#x4E0A;c++&#x7684;&#x5176;&#x5B83;&#x8BBE;&#x65BD;&#x6BD4;&#x5982;&#x5F3A;&#x5236;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x64CD;&#x4F5C;&#x7B26;&#x3001;&#x6790;&#x6784;&#x51FD;&#x6570;&#x7B49;&#x4F7F;&#x6A21;&#x677F;&#x53D8;&#x7684;&#x66F4;&#x52A0;&#x5F3A;&#x5927;&#xFF0C;&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E9B;&#x5173;&#x4E8E;c++&#x6A21;&#x677F;&#x7684;&#x6280;&#x5DE7;&#x7684;&#x793A;&#x4F8B;&#x3002;</p>
<a id="more"></a>
<ul>
<li>Resource Acquisition Is Initialization</li>
<li>Annotating Attributes</li>
<li>Overloading Return Value</li>
<li>Print Array</li>
<li>Get Input</li>
<li>Field (External) Property</li>
<li>Scoping</li>
</ul>
<h1 id="RAII"><a href="#RAII" class="headerlink" title="RAII"></a>RAII</h1><h3 id="AutoClean"><a href="#AutoClean" class="headerlink" title="AutoClean"></a>AutoClean</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> AutoClean {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    AutoClean(T* obj, <span class="keyword">void</span> (T::*impl)())</span><br><span class="line">        :m_object_ptr(obj)</span><br><span class="line">        ,m_impl(impl)</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    T* <span class="keyword">operator</span> -&gt; (){  <span class="comment">// &#x5229;&#x7528;c++&#x7684;&#x6790;&#x6784;&#x51FD;&#x6570;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x65B9;&#x4FBF;&#x7684;&#x7BA1;&#x7406;&#x5206;&#x914D;&#x7684;&#x8D44;&#x6E90;</span></span><br><span class="line">        return <span class="keyword">this</span>-&gt;m_object_ptr;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ~AutoClean()</span><br><span class="line">    {</span><br><span class="line">        (m_object_ptr-&gt;*m_impl)(); <span class="comment">// &#x6808;&#x5BF9;&#x8C61;&#x4F1A;&#x5728;&#x79BB;&#x5F00;&#x4F5C;&#x7528;&#x57DF;&#x540E;&#x6790;&#x6784;&#xFF0C;&#x4E8E;&#x662F;&#x6211;&#x4EEC;&#x7684;&#x51FD;&#x6570;&#x81EA;&#x52A8;&#x7684;&#x8C03;&#x7528;</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    T*  m_object_ptr;</span><br><span class="line">    <span class="keyword">void</span> (T::*m_impl)();</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Mutex {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Lock</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Just Lock this resource!&quot;</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">UnLock</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Oh yeah, UnLock now!&quot;</span>);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">Mutex mu;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>{</span><br><span class="line">    mu.Lock();</span><br><span class="line"></span><br><span class="line">    AutoClean&lt;Mutex&gt; amu(&amp;mu, &amp;Mutex::UnLock);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Main thread exit!&quot;</span>);</span><br><span class="line"></span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="BufferBase"><a href="#BufferBase" class="headerlink" title="BufferBase"></a>BufferBase</h3><p>&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;RAII&#x7BA1;&#x7406;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x5B83;&#x4F1A;&#x5728;&#x79BB;&#x5F00;&#x4F5C;&#x7528;&#x57DF;&#x65F6;&#x81EA;&#x52A8;&#x91CA;&#x653E;&#x5206;&#x914D;&#x7684;&#x5806;&#x5185;&#x5B58;<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;cstddef&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;cstring&gt;</span><br><span class="line"></span><br><span class="line">using std::size_t;</span><br><span class="line">using std::cout;</span><br><span class="line"></span><br><span class="line">template &lt;typename Char, typename BufferType = Char*&gt;</span><br><span class="line">class BufferBase {</span><br><span class="line">public:</span><br><span class="line">    typedef BufferType      buff_type;</span><br><span class="line">    typedef Char            char_type;</span><br><span class="line">    typedef Char            value_type;</span><br><span class="line">    typedef size_t          size_type;</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    explicit BufferBase(size_type size)</span><br><span class="line">        :m_size(size)</span><br><span class="line">        ,m_buff(new char_type[m_size])</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    ~BufferBase()</span><br><span class="line">    {</span><br><span class="line">        delete [] m_buff;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    size_type size() const { return m_size; }</span><br><span class="line"></span><br><span class="line">    operator buff_type () { return m_buff; }</span><br><span class="line"></span><br><span class="line">    buff_type data() const { return m_buff; }</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    size_type   m_size;</span><br><span class="line">    char_type*  m_buff;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">{</span><br><span class="line">    BufferBase&lt;char&gt; buffer(128);</span><br><span class="line"></span><br><span class="line">    std::strcpy(buffer, &quot;I&apos;m your boy&quot;);</span><br><span class="line"></span><br><span class="line">    buffer[0] = &apos;M&apos;;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt;&quot;buffer -&gt; &quot;&lt;&lt;buffer;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h3 id="AutoClean2"><a href="#AutoClean2" class="headerlink" title="AutoClean2"></a>AutoClean2</h3><p>&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x81EA;&#x5DF1;&#x7684;&#x6E05;&#x7406;&#x8D44;&#x6E90;&#x51FD;&#x6570;&#x6216;&#x8005;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x7684;delete&#x7684;&#x6A21;&#x677F;<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt;</span><br><span class="line"><span class="keyword">class</span> AutoCleanHelperBase</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    AutoCleanHelperBase(Tp* ptr)</span><br><span class="line">        :m_ptr(ptr)</span><br><span class="line">    { }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span><br><span class="line">    </span>{}</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">    Tp* m_ptr;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp, <span class="keyword">typename</span> Deleter&gt;</span><br><span class="line"><span class="keyword">class</span> AutoCleanHelper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt;</span><br><span class="line"><span class="keyword">class</span> AutoCleanHelper&lt;Tp, <span class="keyword">void</span>&gt; : <span class="keyword">public</span> AutoCleanHelperBase&lt;Tp&gt;</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    AutoCleanHelper(Tp* ptr)</span><br><span class="line">        :AutoCleanHelperBase&lt;Tp&gt;(ptr)</span><br><span class="line">    { }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="keyword">delete</span> <span class="keyword">this</span>-&gt;m_ptr;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp, <span class="keyword">typename</span> Deleter&gt;</span><br><span class="line"><span class="keyword">class</span> AutoCleanHelper: <span class="keyword">public</span> AutoCleanHelperBase&lt;Tp&gt;</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    AutoCleanHelper(Tp* ptr, Deleter del)</span><br><span class="line">        :AutoCleanHelperBase&lt;Tp&gt;(ptr)</span><br><span class="line">        ,m_del(del)</span><br><span class="line">    { }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        (<span class="keyword">this</span>-&gt;m_ptr-&gt;*m_del)();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Deleter m_del;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt;</span><br><span class="line"><span class="keyword">class</span> AutoClean</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp1&gt;</span><br><span class="line">    AutoClean(Tp1* ptr)</span><br><span class="line">        :m_helper(new AutoCleanHelper&lt;Tp1, <span class="keyword">void</span>&gt;(ptr))</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp1, <span class="keyword">typename</span> Deleter&gt;</span><br><span class="line">    AutoClean(Tp1* ptr, Deleter deleter)</span><br><span class="line">        :m_helper(new AutoCleanHelper&lt;Tp1, Deleter&gt;(ptr, deleter))</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    ~AutoClean()</span><br><span class="line">    {</span><br><span class="line">        m_helper-&gt;destroy();</span><br><span class="line">        <span class="keyword">delete</span> m_helper;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    AutoCleanHelperBase&lt;Tp&gt;* m_helper;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> CanDestroy</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~ CanDestroy()</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;I&apos;m destroy now !!!\n&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> ExplicitDestroy</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;I&apos;m also destroy now !!!\n&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>{</span><br><span class="line">    AutoClean&lt;CanDestroy&gt; clean1(new CanDestroy);</span><br><span class="line"></span><br><span class="line">    AutoClean&lt;ExplicitDestroy&gt; clean2(new ExplicitDestroy, &amp;ExplicitDestroy::destroy);</span><br><span class="line"></span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h1 id="Annotating Attributes"><a href="#Annotating-Attributes" class="headerlink" title="Annotating Attributes"></a>Annotating Attributes</h1><h3 id="sample"><a href="#sample" class="headerlink" title="sample"></a>sample</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Obj {</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span> </span>{ }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">void</span> (Obj::*x)()&gt;</span><br><span class="line"><span class="keyword">struct</span> Trait {</span><br><span class="line"></span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Type {</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">int</span> Tint;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">typename</span> T::Tint)</span> </span>{</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;xxx&quot;</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(T)</span> </span>{</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;www&quot;</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">    Trait&lt;&amp;Obj::func&gt; t1;</span><br><span class="line"></span><br><span class="line">    (<span class="keyword">void</span>)t1;</span><br><span class="line">    f&lt;Type&gt;(<span class="number">10</span>);</span><br><span class="line">    f&lt;<span class="keyword">int</span>&gt;(<span class="number">11</span>);</span><br><span class="line"></span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="Overloading Return Value"><a href="#Overloading-Return-Value" class="headerlink" title="Overloading Return Value"></a>Overloading Return Value</h1><p>&#x6211;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x91CD;&#x8F7D;&#x5F3A;&#x5236;&#x8F6C;&#x6362;&#x64CD;&#x4F5C;&#x7B26;&#x6765;&#x91CD;&#x8F7D;&#x8FD4;&#x56DE;&#x503C;</p>
<h3 id="plus"><a href="#plus" class="headerlink" title="plus"></a>plus</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">string</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> plus</span><br><span class="line">{</span><br><span class="line">	<span class="keyword">int</span> arg1;</span><br><span class="line">	<span class="keyword">int</span> arg2;</span><br><span class="line"></span><br><span class="line">	plus(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span><br><span class="line">	{</span><br><span class="line">		arg1 = x;</span><br><span class="line">		arg2 = y;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="comment">//overload type conversion operator</span></span><br><span class="line">	<span class="function"><span class="keyword">operator</span> <span class="title">int</span> <span class="params">()</span> <span class="keyword">const</span></span><br><span class="line">	</span>{</span><br><span class="line">		return arg1 + arg2;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">operator</span> <span class="title">string</span> <span class="params">()</span> <span class="keyword">const</span></span><br><span class="line">	</span>{</span><br><span class="line">		return <span class="built_in">std</span>::to_string(arg1 + arg2);</span><br><span class="line">	}</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>{</span><br><span class="line">	<span class="keyword">int</span> i = plus(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">string</span> s = plus(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;i&lt;&lt;<span class="string">&quot; -- &quot;</span>&lt;&lt;s&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	return EXIT_SUCCESS;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="Print Array Help"><a href="#Print-Array-Help" class="headerlink" title="Print Array Help"></a>Print Array Help</h1><h3 id="print array"><a href="#print-array" class="headerlink" title="print array"></a>print array</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">template &lt;typename T, size_t N&gt;</span><br><span class="line">void print(T(&amp;array)[N])</span><br><span class="line">{</span><br><span class="line">    for (auto e: array) {</span><br><span class="line">        std::cout &lt;&lt;e&lt;&lt;&quot;\t&quot;;</span><br><span class="line">    }</span><br><span class="line">    std::cout &lt;&lt;&quot;\n&quot;;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">template &lt;typename It&gt;</span><br><span class="line">void print(It beg, It end)</span><br><span class="line">{</span><br><span class="line">    for (;beg &lt; end;++ beg) {</span><br><span class="line">        std::cout &lt;&lt;*beg&lt;&lt;&quot;\t&quot;;</span><br><span class="line">    }</span><br><span class="line">    std::cout &lt;&lt;&quot;\n&quot;;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="Get User Input"><a href="#Get-User-Input" class="headerlink" title="Get User Input"></a>Get User Input</h1><h3 id="get"><a href="#get" class="headerlink" title="get"></a>get</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">get</span><span class="params">()</span></span><br><span class="line"></span>{</span><br><span class="line">    T in;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> {</span><br><span class="line">        <span class="keyword">if</span> (!(std::cin &gt;&gt;in)) {</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cin</span>.clear(), <span class="built_in">std</span>::<span class="built_in">cin</span>.ignore();</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">while</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    return in;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="Property"><a href="#Property" class="headerlink" title="Property"></a>Property</h1><p>c++&#x6CA1;&#x6709;&#x5C5E;&#x6027;&#x8FD9;&#x4E00;&#x8BBE;&#x65BD;&#xFF0C;&#x4E0D;&#x8FC7;<code>Imperfect c++</code>&#x4E2D;&#x7684;&#x8BB2;&#x89E3;&#x4E86;&#x5982;&#x4F55;&#x4F7F;&#x7528;c++&#x7684;&#x6A21;&#x677F;&#x6765;&#x5B9E;&#x73B0;&#x5C5E;&#x6027;</p>
<h3 id="ReadOnly Property"><a href="#ReadOnly-Property" class="headerlink" title="ReadOnly Property"></a>ReadOnly Property</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SET_TEMPLATE_ARG_AS_FRINED(c)  \</span><br><span class="line">    fri##end c</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> V, <span class="keyword">typename</span> R, <span class="keyword">typename</span> F&gt;</span><br><span class="line"><span class="keyword">class</span> ReadOnlyProperty</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">typedef</span> V value_type;</span><br><span class="line">    <span class="keyword">typedef</span> R reference_type;</span><br><span class="line">    <span class="keyword">typedef</span> F friend_type;</span><br><span class="line">    <span class="keyword">typedef</span> ReadOnlyProperty&lt;value_type,    \</span><br><span class="line">        reference_type, friend_type&gt; class_type;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ReadOnlyProperty()</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    ReadOnlyProperty(<span class="keyword">const</span> value_type&amp; r)</span><br><span class="line">        :m_value(r)</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    SET_TEMPLATE_ARG_AS_FRINED(friend_type);</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">reference_type</span> <span class="params">()</span> <span class="keyword">const</span></span><br><span class="line">    </span>{</span><br><span class="line">        return m_value;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    value_type m_value;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ReadOnlyProperty(<span class="keyword">const</span> ReadOnlyProperty &amp;r) = <span class="keyword">delete</span>; <span class="comment">//c++11</span></span><br><span class="line">    ReadOnlyProperty&amp; <span class="keyword">operator</span> = (const ReadOnlyProperty&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h3 id="ReadOnly External Property"><a href="#ReadOnly-External-Property" class="headerlink" title="ReadOnly External Property"></a>ReadOnly External Property</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> V, <span class="keyword">typename</span> R&gt;</span><br><span class="line"><span class="keyword">class</span> ReadOnlyExternalProperty</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">typedef</span> V value_type;</span><br><span class="line">    <span class="keyword">typedef</span> R reference_type;</span><br><span class="line">    <span class="keyword">typedef</span> ReadOnlyExternalProperty&lt;value_type,    \</span><br><span class="line">        reference_type&gt; class_type;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ReadOnlyExternalProperty(value_type&amp; vref)</span><br><span class="line">        :m_vref(vref)</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">reference_type</span><span class="params">()</span> <span class="keyword">const</span></span><br><span class="line">    </span>{</span><br><span class="line">        return m_vref;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"></span><br><span class="line">    value_type&amp; m_vref;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ReadOnlyExternalProperty(<span class="keyword">const</span> ReadOnlyExternalProperty&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">    ReadOnlyExternalProperty&amp; <span class="keyword">operator</span> = (const ReadOnlyExternalProperty&amp;) = <span class="keyword">delete</span>;</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h3 id="sample"><a href="#sample-1" class="headerlink" title="sample"></a>sample</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> LinkList {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ReadOnlyProperty&lt;<span class="keyword">int</span>, <span class="keyword">int</span>, LinkList&gt; Count;</span><br><span class="line">    ReadOnlyExternalProperty&lt;<span class="keyword">size_t</span>, <span class="keyword">size_t</span>&gt; Length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    LinkList()</span><br><span class="line">        :Count(<span class="number">0</span>)</span><br><span class="line">        ,Length(m_length)</span><br><span class="line">        ,m_length(<span class="number">0</span>)</span><br><span class="line">    {}</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        Count.m_value ++;</span><br><span class="line">        m_length ++;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">()</span></span><br><span class="line">    </span>{</span><br><span class="line">        Count.m_value --;</span><br><span class="line">        m_length --;</span><br><span class="line">    }</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">size_t</span> m_length;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>{</span><br><span class="line">    LinkList <span class="built_in">list</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;create a list with count -&gt; &quot;</span>&lt;&lt;<span class="built_in">list</span>.Count&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;create a list with length -&gt; &quot;</span>&lt;&lt;<span class="built_in">list</span>.Length&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">list</span>.add();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;after add -&gt; &quot;</span>&lt;&lt;<span class="built_in">list</span>.Count&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;after add -&gt; &quot;</span>&lt;&lt;<span class="built_in">list</span>.Length&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">list</span>.del();</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;after del -&gt; &quot;</span>&lt;&lt;<span class="built_in">list</span>.Count&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;after add -&gt; &quot;</span>&lt;&lt;<span class="built_in">list</span>.Length&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h1 id="Scoping"><a href="#Scoping" class="headerlink" title="Scoping"></a>Scoping</h1><p>&#x8FD9;&#x4E5F;&#x662F;&#x6765;&#x81EA;<code>Imperfect c++</code>&#x4E2D;&#x7684;&#x4F8B;&#x5B50;&#xFF0C;&#x4F5C;&#x7528;&#x57DF;&#x5B88;&#x536B;&#x53EF;&#x4EE5;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#x5E2E;&#x52A9;&#x4F60;&#x5199;&#x51FA;&#x4F18;&#x7F8E;&#x7684;&#x4EE3;&#x7801;</p>
<h3 id="Increment Scoping"><a href="#Increment-Scoping" class="headerlink" title="Increment Scoping"></a>Increment Scoping</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">template &lt;typename T&gt;</span><br><span class="line">struct SimpleIncrementer</span><br><span class="line">{</span><br><span class="line">    void operator ()(T&amp; t)</span><br><span class="line">    {</span><br><span class="line">        ++t;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">template &lt;typename T&gt;</span><br><span class="line">struct SimpleDecrementer</span><br><span class="line">{</span><br><span class="line">    void operator ()(T&amp; t)</span><br><span class="line">    {</span><br><span class="line">        --t;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">template &lt;typename T,</span><br><span class="line">          typename F = SimpleIncrementer&lt;T&gt;,</span><br><span class="line">          typename S = SimpleDecrementer&lt;T&gt;&gt;</span><br><span class="line">class IncrementScoping</span><br><span class="line">{</span><br><span class="line">public:</span><br><span class="line">    typedef T value_type;</span><br><span class="line">    typedef F first_op;</span><br><span class="line">    typedef S second_op;</span><br><span class="line"></span><br><span class="line">    explicit IncrementScoping(value_type&amp; ref)</span><br><span class="line">        :m_ref(ref)</span><br><span class="line">    {</span><br><span class="line">        first_op()(m_ref);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ~IncrementScoping()</span><br><span class="line">    {</span><br><span class="line">        second_op()(m_ref);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">private:</span><br><span class="line">    value_type&amp; m_ref;</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h3 id="Value Change Scoping"><a href="#Value-Change-Scoping" class="headerlink" title="Value Change Scoping"></a>Value Change Scoping</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> ValueScoping</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">typedef</span> T value_type;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> O&gt;</span><br><span class="line">    ValueScoping(value_type&amp; var, <span class="keyword">const</span> O&amp; <span class="built_in">set</span>)</span><br><span class="line">        :m_ref(var)</span><br><span class="line">        ,m_restore(var)</span><br><span class="line">    {</span><br><span class="line">        m_ref = <span class="built_in">set</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> O&gt;</span><br><span class="line">    ValueScoping(value_type&amp; var, <span class="keyword">const</span> O&amp; <span class="built_in">set</span>, <span class="keyword">const</span> value_type&amp; restore)</span><br><span class="line">        :m_ref(var)</span><br><span class="line">        ,m_restore(restore)</span><br><span class="line">    {</span><br><span class="line">        m_ref = <span class="built_in">set</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ~ValueScoping()</span><br><span class="line">    {</span><br><span class="line">        m_ref = m_restore;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    value_type&amp;     m_ref;</span><br><span class="line">    value_type      m_restore;</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h3 id="Lock Scoping"><a href="#Lock-Scoping" class="headerlink" title="Lock Scoping"></a>Lock Scoping</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> L&gt;</span><br><span class="line"><span class="keyword">struct</span> LockHelper</span><br><span class="line">{</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">lock</span><span class="params">(L&amp; l)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="comment">//add this inline *real_lock* function to your class header</span></span><br><span class="line">        real_lock(l);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">unlock</span><span class="params">(L&amp; l)</span></span><br><span class="line">    </span>{</span><br><span class="line">        <span class="comment">//add this inline *real_unlock* function to your class header</span></span><br><span class="line">        real_unlock(l);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> L,</span><br><span class="line">          <span class="keyword">typename</span> H = LockHelper&lt;L&gt;&gt;</span><br><span class="line"><span class="keyword">class</span> LockScoping</span><br><span class="line">{</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">explicit</span> LockScoping(L&amp; lock)</span><br><span class="line">        :m_lock(lock)</span><br><span class="line">    {</span><br><span class="line">        H::lock(m_lock);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ~LockScoping()</span><br><span class="line">    {</span><br><span class="line">        H::unlock(m_lock);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    L&amp; m_lock;</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<h3 id="sample"><a href="#sample-2" class="headerlink" title="sample"></a>sample</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>{</span><br><span class="line">		{</span><br><span class="line">            <span class="keyword">int</span> var1 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;Before .. value = &quot;</span>&lt;&lt;var1&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            {</span><br><span class="line">                IncrementScoping&lt;<span class="keyword">int</span>&gt; int_scope(var1);</span><br><span class="line"></span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;Current value = &quot;</span>&lt;&lt;var1&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;After .. value = &quot;</span>&lt;&lt;var1&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">string</span> original_str = <span class="string">&quot;Original&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;Before .. original_str = &quot;</span>&lt;&lt;original_str&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            {</span><br><span class="line">                ValueScoping&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; str_scope(original_str, <span class="string">&quot;Temp Value&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;Current original_str = &quot;</span>&lt;&lt;original_str&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt;<span class="string">&quot;After .. original_str = &quot;</span>&lt;&lt;original_str&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    	return <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
	  
	</div>

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
    	<li class="prev"><a href="/05-23-2016/Linux移除应用程序启动通知/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>上一页</a></li>
  		

        <li><a href="/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
		   <li class="next"><a href="/05-17-2016/简单括号匹配/" class="alignright next">下一页<i class="fa fa-arrow-circle-o-right"></i></a></li>         
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        
    <div class="bdsharebuttonbox">
        <a href="#" class="bds_more" data-cmd="more"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
        <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
        <a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
        <a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a>
        <a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a>
        <a href="#" class="bds_copy" data-cmd="copy" title="分享到复制网址"></a>
    </div>
    <script>
        window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{}};
        with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>


        

    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">留言</h2>

  
  	 <div class="ds-thread" data-thread-key="05-23-2016/c++模板的技巧示例/" data-title="Linux移除应用程序启动通知" data-url="http://araraloren.com/05-23-2016/c++模板的技巧示例/"></div>  
  
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	05-23-2016 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/c/">c++<span>2</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/c/">c++<span>3</span></a></li> <li><a href="/tags/raii/">raii<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->

<script type="text/javascript">
  var duoshuoQuery = { short_name: 'araraloren' };
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
Copyright &copy 2016 araraloren 保留所有权利
</p>
</br>
<p>
  &copy; 2016 araraloren
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p>


 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
